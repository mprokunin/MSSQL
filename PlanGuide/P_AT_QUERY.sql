/*
(
@P10 numeric(10,0),
@P11 numeric(10,0),
@P12 numeric(10,0),
@P13 datetime2(3),
@P14 datetime2(3),
@P15 varbinary(16),
@P16 varbinary(16),
@P17 varbinary(16),
@P18 numeric(10,0),
@P19 varbinary(16))
@P20 varbinary(16),
@P21 datetime2(3),
@P22 varbinary(16),
@P23 varbinary(16),
@P24 varbinary(16),
@P25 numeric(10,0),
@P26 numeric(10,0),
@P27 numeric(10,0),
@P28 numeric(10,0),
@P29 numeric(10,0),
@P30 numeric(10,0),
@P31 datetime2(3),
@P32 datetime2(3),
@P33 varbinary(16),
@P34 varbinary(16),
@P35 varbinary(16),
@P1 varbinary(16),
@P2 varbinary(16),
@P3 datetime2(3),
@P4 varbinary(16),
@P5 varbinary(16),
@P6 varbinary(16),
@P7 numeric(10,0),
@P8 numeric(10,0),
@P9 numeric(10,0),
*/

SELECT
T5._Fld6814,
T1.Fld9307RRef,
T1.Fld9308Balance_,
T1.Fld9309Balance_,
T1.Fld10145Balance_,
CASE WHEN (T5._Fld6778RRef IN (0xA2E6984BE167C95E11E8E386760E57EA, 0xA2E6984BE167C95E11E8E8EA4D7A20CA)) THEN T5._Fld6790RRef ELSE T5._Fld6787RRef END
FROM (SELECT
T2.Fld9307RRef AS Fld9307RRef,
CAST(SUM(T2.Fld9309Balance_) AS NUMERIC(38, 8)) AS Fld9309Balance_,
CAST(SUM(T2.Fld9308Balance_) AS NUMERIC(38, 8)) AS Fld9308Balance_,
CAST(SUM(T2.Fld10145Balance_) AS NUMERIC(38, 8)) AS Fld10145Balance_
FROM (SELECT
T3._Fld9307RRef AS Fld9307RRef,
CAST(SUM(T3._Fld9309) AS NUMERIC(33, 8)) AS Fld9309Balance_,
CAST(SUM(T3._Fld9308) AS NUMERIC(35, 8)) AS Fld9308Balance_,
CAST(SUM(T3._Fld10145) AS NUMERIC(33, 8)) AS Fld10145Balance_
FROM dbo._AccumRgT9315 T3
WHERE T3._Period = '3999-11-01 00:00:00.000' AND ((((T3._Fld9304RRef = 0x895EAB70A9C571C5420BBA657C88E705) AND (T3._Fld9306RRef = 0x81160050569216CF11E96AEC66CBB901)) AND (T3._Fld9305_TYPE = 0x08 AND T3._Fld9305_RTRef = 0x0000005C AND T3._Fld9305_RRRef = 0x81FE000C29A8197011E8EBF83B3C6772))) AND (T3._Fld9309 <> 0. OR T3._Fld9308 <> 0. OR T3._Fld10145 <> 0.) AND (T3._Fld9309 <> 0. OR T3._Fld9308 <> 0. OR T3._Fld10145 <> 0.)
GROUP BY T3._Fld9307RRef
HAVING (CAST(SUM(T3._Fld9309) AS NUMERIC(33, 8))) <> 0.0 OR (CAST(SUM(T3._Fld9308) AS NUMERIC(35, 8))) <> 0.0 OR (CAST(SUM(T3._Fld10145) AS NUMERIC(33, 8))) <> 0.0
UNION ALL SELECT
T4._Fld9307RRef AS Fld9307RRef,
CAST(CAST(SUM(CASE WHEN T4._RecordKind = 0.0 THEN -T4._Fld9309 ELSE T4._Fld9309 END) AS NUMERIC(27, 8)) AS NUMERIC(27, 2)) AS Fld9309Balance_,
CAST(CAST(SUM(CASE WHEN T4._RecordKind = 0.0 THEN -T4._Fld9308 ELSE T4._Fld9308 END) AS NUMERIC(29, 8)) AS NUMERIC(30, 3)) AS Fld9308Balance_,
CAST(CAST(SUM(CASE WHEN T4._RecordKind = 0.0 THEN -T4._Fld10145 ELSE T4._Fld10145 END) AS NUMERIC(27, 8)) AS NUMERIC(27, 2)) AS Fld10145Balance_
FROM dbo._AccumRg9303 T4
WHERE T4._Period >= '2019-05-06 23:59:59.000' AND T4._Period < '3999-11-01 00:00:00.000' AND T4._Active = 0x01 AND ((((T4._Fld9304RRef = 0x895EAB70A9C571C5420BBA657C88E705) AND (T4._Fld9306RRef = 0x81160050569216CF11E96AEC66CBB901)) AND (T4._Fld9305_TYPE = 0x08 AND T4._Fld9305_RTRef = 0x0000005C AND T4._Fld9305_RRRef = 0x81FE000C29A8197011E8EBF83B3C6772)))
GROUP BY T4._Fld9307RRef
HAVING (CAST(CAST(SUM(CASE WHEN T4._RecordKind = 0.0 THEN -T4._Fld9309 ELSE T4._Fld9309 END) AS NUMERIC(27, 8)) AS NUMERIC(27, 2))) <> 0.0 OR (CAST(CAST(SUM(CASE WHEN T4._RecordKind = 0.0 THEN -T4._Fld9308 ELSE T4._Fld9308 END) AS NUMERIC(29, 8)) AS NUMERIC(30, 3))) <> 0.0 OR (CAST(CAST(SUM(CASE WHEN T4._RecordKind = 0.0 THEN -T4._Fld10145 ELSE T4._Fld10145 END) AS NUMERIC(27, 8)) AS NUMERIC(27, 2))) <> 0.0) T2
GROUP BY T2.Fld9307RRef
HAVING (CAST(SUM(T2.Fld9309Balance_) AS NUMERIC(38, 8))) <> 0.0 OR (CAST(SUM(T2.Fld9308Balance_) AS NUMERIC(38, 8))) <> 0.0 OR (CAST(SUM(T2.Fld10145Balance_) AS NUMERIC(38, 8))) <> 0.0) T1
LEFT OUTER JOIN dbo._Document237 T5
ON (T1.Fld9307RRef = T5._IDRRef)
WHERE (T1.Fld9308Balance_ < 0.)
UNION SELECT
T10._Fld6814,
T6.Fld9294RRef,
T6.Fld9295Balance_,
T6.Fld9296Balance_,
T6.Fld10144Balance_,
CASE WHEN (T10._Fld6778RRef IN (0xA2E6984BE167C95E11E8E386760E57EA, 0xA2E6984BE167C95E11E8E8EA4D7A20CA)) THEN T10._Fld6790RRef ELSE T10._Fld6787RRef END
FROM (SELECT
T7.Fld9294RRef AS Fld9294RRef,
CAST(SUM(T7.Fld9296Balance_) AS NUMERIC(38, 8)) AS Fld9296Balance_,
CAST(SUM(T7.Fld9295Balance_) AS NUMERIC(38, 8)) AS Fld9295Balance_,
CAST(SUM(T7.Fld10144Balance_) AS NUMERIC(38, 8)) AS Fld10144Balance_
FROM (SELECT
T8._Fld9294RRef AS Fld9294RRef,
CAST(SUM(T8._Fld9296) AS NUMERIC(33, 8)) AS Fld9296Balance_,
CAST(SUM(T8._Fld9295) AS NUMERIC(35, 8)) AS Fld9295Balance_,
CAST(SUM(T8._Fld10144) AS NUMERIC(33, 8)) AS Fld10144Balance_
FROM dbo._AccumRgT9302 T8
WHERE T8._Period = '3999-11-01 00:00:00.000' AND ((((T8._Fld9291RRef = 0x895EAB70A9C571C5420BBA657C88E705) AND (T8._Fld9293RRef = 0x81160050569216CF11E96AEC66CBB901)) AND (T8._Fld9292_TYPE = 0x08 AND T8._Fld9292_RTRef = 0x0000005C AND T8._Fld9292_RRRef = 0x81FE000C29A8197011E8EBF83B3C6772))) AND (T8._Fld9296 <> 0. OR T8._Fld9295 <> 0. OR T8._Fld10144 <> 0.) AND (T8._Fld9296 <> 0. OR T8._Fld9295 <> 0. OR T8._Fld10144 <> 0.)
GROUP BY T8._Fld9294RRef
HAVING (CAST(SUM(T8._Fld9296) AS NUMERIC(33, 8))) <> 0.0 OR (CAST(SUM(T8._Fld9295) AS NUMERIC(35, 8))) <> 0.0 OR (CAST(SUM(T8._Fld10144) AS NUMERIC(33, 8))) <> 0.0
UNION ALL SELECT
T9._Fld9294RRef AS Fld9294RRef,
CAST(CAST(SUM(CASE WHEN T9._RecordKind = 0.0 THEN -T9._Fld9296 ELSE T9._Fld9296 END) AS NUMERIC(27, 8)) AS NUMERIC(27, 2)) AS Fld9296Balance_,
CAST(CAST(SUM(CASE WHEN T9._RecordKind = 0.0 THEN -T9._Fld9295 ELSE T9._Fld9295 END) AS NUMERIC(29, 8)) AS NUMERIC(30, 3)) AS Fld9295Balance_,
CAST(CAST(SUM(CASE WHEN T9._RecordKind = 0.0 THEN -T9._Fld10144 ELSE T9._Fld10144 END) AS NUMERIC(27, 8)) AS NUMERIC(27, 2)) AS Fld10144Balance_
FROM dbo._AccumRg9290 T9
WHERE T9._Period >= '2019-05-06 23:59:59.000' AND T9._Period < '3999-11-01 00:00:00.000' AND T9._Active = 0x01 AND ((((T9._Fld9291RRef = 0x895EAB70A9C571C5420BBA657C88E705) AND (T9._Fld9293RRef = 0x81160050569216CF11E96AEC66CBB901)) AND (T9._Fld9292_TYPE = 0x08 AND T9._Fld9292_RTRef = 0x0000005C AND T9._Fld9292_RRRef = 0x81FE000C29A8197011E8EBF83B3C6772)))
GROUP BY T9._Fld9294RRef
HAVING (CAST(CAST(SUM(CASE WHEN T9._RecordKind = 0.0 THEN -T9._Fld9296 ELSE T9._Fld9296 END) AS NUMERIC(27, 8)) AS NUMERIC(27, 2))) <> 0.0 OR (CAST(CAST(SUM(CASE WHEN T9._RecordKind = 0.0 THEN -T9._Fld9295 ELSE T9._Fld9295 END) AS NUMERIC(29, 8)) AS NUMERIC(30, 3))) <> 0.0 OR (CAST(CAST(SUM(CASE WHEN T9._RecordKind = 0.0 THEN -T9._Fld10144 ELSE T9._Fld10144 END) AS NUMERIC(27, 8)) AS NUMERIC(27, 2))) <> 0.0) T7
GROUP BY T7.Fld9294RRef
HAVING (CAST(SUM(T7.Fld9296Balance_) AS NUMERIC(38, 8))) <> 0.0 OR (CAST(SUM(T7.Fld9295Balance_) AS NUMERIC(38, 8))) <> 0.0 OR (CAST(SUM(T7.Fld10144Balance_) AS NUMERIC(38, 8))) <> 0.0) T6
LEFT OUTER JOIN dbo._Document237 T10
ON (T6.Fld9294RRef = T10._IDRRef)
ORDER BY 1, 2

